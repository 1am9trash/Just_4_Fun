(this.webpackJsonpjust_4_fun=this.webpackJsonpjust_4_fun||[]).push([[0],{258:function(e,t,a){"use strict";a.r(t);var s=a(0),n=a(37),c=a.n(n),r=a(3),i=a(7),l=(a(169),a(268)),o=a(83),j=a(54),d=a(262),u=a(261),b=a(266),h=a(267),O=a(269),x=a(8);function g(e){function t(t,a,s,n){for(var c=Object.assign({},e.tags),r=0;r<n.length;r++)c[n[r]].count--,0===c[n[r]].count&&delete c[n[r]];e.setTags(c),e.setData(e.data.filter((function(e){return e.schoolYear!==t||e.semester!==a||e.classId!==s})))}var a,n,c,r,l=Object(s.useState)({}),d=Object(i.a)(l,2),u=d[0],g=d[1];return Object(x.jsx)("div",{style:{maxHeight:"360px",overflowY:"scroll",overflowX:"hidden"},children:e.filteredData.map((function(s){return s.schoolYear===u.schoolYear&&s.semester===u.semester&&s.classId===u.classId?Object(x.jsxs)(o.a,{gutter:8,align:"middle",style:{paddingBottom:"3px",borderBottom:"1px #f0f0f0 solid",minHeight:"50px",fontSize:"16px"},children:[Object(x.jsx)(j.a,{span:8,children:Object(x.jsx)(b.a,{onChange:function(e){return a=e.target.value},defaultValue:s.name})}),Object(x.jsx)(j.a,{span:4,children:Object(x.jsx)(b.a,{onChange:function(e){return n=e.target.value},defaultValue:s.credit})}),Object(x.jsx)(j.a,{span:4,children:Object(x.jsx)(b.a,{onChange:function(e){return c=e.target.value},defaultValue:s.score})}),Object(x.jsx)(j.a,{span:4,children:Object(x.jsx)(h.a,{onChange:function(e){return r=e},mode:"tags",defaultValue:s.tags,style:{width:"100%"}})}),Object(x.jsxs)(j.a,{span:4,children:[Object(x.jsx)("a",{href:"# ",onClick:function(t){t.preventDefault(),g({}),function(){var t=[],s=e.data.map((function(e,s){return e.schoolYear===u.schoolYear&&e.semester===u.semester&&e.classId===u.classId?(t=void 0!==e.tags?e.tags:t,Object.assign(e,{name:void 0!==a?a:e.name,credit:void 0===n||isNaN(n)?e.credit:Number(n),score:void 0===c||isNaN(c)?e.score:Number(c),tags:void 0!==r?r:e.tags})):e}));if(void 0!==r){for(var i=Object.assign({},e.tags),l=0;l<t.length;l++)i[t[l]].count--,0===i[t[l]].count&&delete i[t[l]];for(var o=0;o<r.length;o++)void 0===i[r[o]]?i[r[o]]={count:1}:i[r[o]].count++;e.setTags(i)}e.setData(s)}()},children:"\u78ba\u5b9a"}),"\xa0",Object(x.jsx)("a",{href:"# ",onClick:function(e){e.preventDefault(),t(s.schoolYear,s.semester,s.classId,s.tags)},children:"\u522a\u9664"})]})]},""+s.schoolYear+s.semester+s.classId):Object(x.jsxs)(o.a,{gutter:8,align:"middle",style:{paddingBottom:"3px",borderBottom:"1px #f0f0f0 solid",minHeight:"50px",fontSize:"16px"},children:[Object(x.jsx)(j.a,{span:8,children:s.name}),Object(x.jsxs)(j.a,{span:4,children:[s.credit," \u5b78\u5206"]}),Object(x.jsxs)(j.a,{span:4,children:[s.score,isNaN(s.score)?"":"\u5206"," "]}),Object(x.jsx)(j.a,{span:4,children:s.tags.map((function(e){return Object(x.jsx)(O.a,{color:"red",children:e},e)}))}),Object(x.jsxs)(j.a,{span:4,children:[Object(x.jsx)("a",{href:"# ",onClick:function(e){e.preventDefault(),g({schoolYear:s.schoolYear,semester:s.semester,classId:s.classId})},children:"\u7de8\u8f2f"}),"\xa0",Object(x.jsx)("a",{href:"# ",onClick:function(e){e.preventDefault(),t(s.schoolYear,s.semester,s.classId,s.tags)},children:"\u522a\u9664"})]})]},""+s.schoolYear+s.semester+s.classId)}))})}var f=a(264);function p(e){var t=e.filteredData.filter((function(e){return!isNaN(e.score)})),a=t.reduce((function(e,t){return e+t.credit}),0),n=t.reduce((function(e,t){return e+(t.score<60?t.credit:0)}),0),c=t.reduce((function(e,t){return e+t.score*t.credit}),0),r=t.reduce((function(e,t){return e+(4.3*(t.score>=90)+4*(t.score>=85&&t.score<90)+3.7*(t.score>=80&&t.score<85)+3.3*(t.score>=77&&t.score<80)+3*(t.score>=73&&t.score<77)+2.7*(t.score>=70&&t.score<73)+2.3*(t.score>=67&&t.score<70)+2*(t.score>=63&&t.score<67)+1.7*(t.score>=60&&t.score<63)+1*(t.score>=50&&t.score<60))*t.credit}),0),l=t.reduce((function(e,t){return e+(4*(t.score>=80)+3*(t.score>=70&&t.score<80)+2*(t.score>=60&&t.score<70)+1*(t.score>=50&&t.score<60))*t.credit}),0),o=Object(s.useState)(!1),j=Object(i.a)(o,2),d=j[0],u=j[1],h=Object(s.useRef)(null),O=Object(s.useRef)(null),g=e.tagsStandard[e.tag];return void 0===g&&(g=[0,0]),d?Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(f.a,{title:"\u5b78\u5206\u6a19\u6e96",value:a-n,suffix:Object(x.jsxs)(x.Fragment,{children:["/"," ",Object(x.jsx)(b.a,{ref:h,defaultValue:g[0],style:{width:"50px"}})]})}),Object(x.jsx)(f.a,{title:"\u4fee\u8ab2\u6578\u91cf\u6a19\u6e96",value:e.filteredData.length,suffix:Object(x.jsxs)(x.Fragment,{children:["/"," ",Object(x.jsx)(b.a,{ref:O,defaultValue:g[1],style:{width:"50px"}})]})}),Object(x.jsx)(f.a,{title:"GPA 4.3",value:0!==a?r/a:"None",precision:2}),Object(x.jsx)(f.a,{title:"GPA 4.0",value:0!==a?l/a:"None",precision:2}),Object(x.jsx)(f.a,{title:"\u5e73\u5747\u6210\u7e3e",value:0!==a?c/a:"None",precision:2}),Object(x.jsx)("a",{href:"# ",onClick:function(t){t.preventDefault(),u(!1),function(){var t=Object.assign({},e.tagsStandard),a=isNaN(h.current.input.value)?0:Number(h.current.input.value)>1e3?999:Number(h.current.input.value),s=isNaN(O.current.input.value)?0:Number(O.current.input.value)>1e3?999:Number(O.current.input.value);t[e.tag]=[a,s],e.setTagsStandard(t)}()},style:{fontSize:"16px"},children:"\u78ba\u5b9a"})]}):Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(f.a,{title:"\u5b78\u5206\u6a19\u6e96",value:a-n,suffix:Object(x.jsxs)(x.Fragment,{children:["/ ",g[0]]})}),Object(x.jsx)(f.a,{title:"\u4fee\u8ab2\u6578\u91cf\u6a19\u6e96",value:e.filteredData.length,suffix:Object(x.jsxs)(x.Fragment,{children:["/ ",g[1]]})}),Object(x.jsx)(f.a,{title:"GPA 4.3",value:0!==a?r/a:"None",precision:2}),Object(x.jsx)(f.a,{title:"GPA 4.0",value:0!==a?l/a:"None",precision:2}),Object(x.jsx)(f.a,{title:"\u5e73\u5747\u6210\u7e3e",value:0!==a?c/a:"None",precision:2}),Object(x.jsx)("a",{href:"# ",onClick:function(e){e.preventDefault(),u(!0)},style:{fontSize:"16px"},children:"\u7de8\u8f2f"})]})}function m(e){return Object(x.jsx)(d.a,{bordered:!1,style:{overflow:"scroll"},children:Object(x.jsxs)(o.a,{style:{minWidth:"600px",overflow:"scroll"},children:[Object(x.jsx)(j.a,{span:4,children:Object(x.jsx)(p,Object(r.a)({},e))}),Object(x.jsx)(j.a,{span:2,children:Object(x.jsx)(u.a,{type:"vertical",style:{height:"100%"}})}),Object(x.jsx)(j.a,{span:18,children:Object(x.jsx)(g,Object(r.a)({},e))})]})})}var v=a(161);function y(e){var t="";return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("div",{children:"\u53ef\u5c0e\u5165\u967d\u660e\u4ea4\u901a\u5927\u5b78\u7684\u6210\u7e3e\uff0c\u65bc\u5b78\u7c4d\u6210\u7e3e\u7cfb\u7d71\u5168\u9078\u8907\u88fd\u8cbc\u4e0a\u5373\u53ef\u3002"}),Object(x.jsx)(b.a,{type:"text",onChange:function(e){return t=e.target.value},style:{marginTop:"8px"}}),Object(x.jsx)(v.a,{type:"primary",block:!0,onClick:function(){for(var a=t.split(/[ \t]/).filter((function(e){return""!==e})),s={},n=[],c=!1,r=0;!c&&r<a.length;)"\u5411\u5ea6"===a[r]&&(c=!0),r++;for(var i=r;i<a.length&&!isNaN(a[i]);i++)if(isNaN(a[i+7])&&"\u901a\u904e"!==a[i+7]&&"W"!==a[i+7])i+=9;else{var l={};if(l.schoolYear=parseInt(Number(a[i+1])/10),l.semester=Number(a[i+1])%10,l.classId=Number(a[i+2]),l.unit=a[i+3],l.name=a[i+4],l.credit=Number(a[i+6]),l.score=isNaN(a[i+7])?a[i+7]:Number(a[i+7]),l.teacher=a[i+11],l.tags=[],void 0!==e.tagsStandard[a[i+5]]&&l.tags.push(a[i+5]),isNaN(a[i+12])){if(void 0!==e.tagsStandard[a[i+12]]){for(var o=!1,j=0;j<l.tags.length;j++)if(l.tags[j]===a[i+12]){o=!0;break}o||l.tags.push(a[i+12])}i+=12}else i+=11;for(var d=0;d<l.tags.length;d++)void 0!==s[l.tags[d]]?s[l.tags[d]].count+=1:s[l.tags[d]]={count:1};n.push(l)}e.setTags(s),e.setData(n)},style:{marginTop:"8px"},children:"\u5c0e\u5165"})]})}var N=a(11),I=a(263),S=a(265),k=h.a.Option;function C(e){var t=I.a.useForm(),a=Object(i.a)(t,1)[0];return Object(x.jsxs)(I.a,{layout:"horizontal",labelCol:{span:8},wrapperCol:{span:16},initialValues:{schoolYear:110,semester:0,score:100,credit:0},onFinish:function(t){void 0===t.tags&&(t.tags=[]),t.classId=Math.random();for(var s={},n=0;n<t.tags.length;n++)void 0===e.tags[t.tags[n]]?s[t.tags[n]]={count:1}:s[t.tags[n]]={count:e.tags[t.tags[n]].count+1};e.setTags(Object(r.a)(Object(r.a)({},e.tags),s)),e.setData([].concat(Object(N.a)(e.data),[t])),a.resetFields()},form:a,children:[Object(x.jsx)(I.a.Item,{label:"\u5b78\u5e74",name:"schoolYear",children:Object(x.jsx)(S.a,{})}),Object(x.jsx)(I.a.Item,{label:"\u5b78\u671f",name:"semester",children:Object(x.jsxs)(h.a,{children:[Object(x.jsx)(k,{value:0,children:"\u672a\u9078\u64c7"}),Object(x.jsx)(k,{value:1,children:"\u4e0a"}),Object(x.jsx)(k,{value:2,children:"\u4e0b"})]})}),Object(x.jsx)(I.a.Item,{label:"\u958b\u8ab2\u55ae\u4f4d",name:"unit",children:Object(x.jsx)(b.a,{})}),Object(x.jsx)(I.a.Item,{label:"\u8ab2\u7a0b\u540d\u7a31",name:"name",children:Object(x.jsx)(b.a,{})}),Object(x.jsx)(I.a.Item,{label:"\u5206\u6578",name:"score",children:Object(x.jsx)(S.a,{})}),Object(x.jsx)(I.a.Item,{label:"\u6a19\u7c64",name:"tags",children:Object(x.jsx)(h.a,{mode:"tags",children:Object.keys(e.tagsStandard).map((function(e){return"\u5168\u90e8\u4fee\u8ab2"===e||"\u672a\u5206\u985e"===e?"":Object(x.jsx)(k,{children:e},e)}))})}),Object(x.jsx)(I.a.Item,{label:"\u5b78\u5206",name:"credit",children:Object(x.jsx)(S.a,{})}),Object(x.jsx)(I.a.Item,{label:"\u6559\u6388",name:"teacher",children:Object(x.jsx)(b.a,{})}),Object(x.jsx)(I.a.Item,{colon:!1,label:" ",children:Object(x.jsx)(v.a,{type:"primary",block:!0,htmlType:"submit",children:"\u65b0\u589e"})})]})}var D=a(52),Y=(a(259),a(253),a(255),a(160));function A(e){var t=Object(s.useState)(null),a=Object(i.a)(t,2),n=a[0],c=a[1];Object(s.useEffect)((function(){var e=D.a.auth().onAuthStateChanged((function(e){c(e)}));return function(){e()}}),[]);var r="",l="";return null===n?Object(x.jsx)(x.Fragment,{children:Object(x.jsxs)(o.a,{gutter:[8,8],align:"middle",children:[Object(x.jsx)(j.a,{span:8,style:{textAlign:"right"},children:"\u4fe1\u7bb1\uff1a"}),Object(x.jsx)(j.a,{span:16,children:Object(x.jsx)(b.a,{type:"text",onChange:function(e){return r=e.target.value}})}),Object(x.jsx)(j.a,{span:8,style:{textAlign:"right"},children:"\u5bc6\u78bc\uff1a"}),Object(x.jsx)(j.a,{span:16,children:Object(x.jsx)(b.a,{type:"text",onChange:function(e){return l=e.target.value}})}),Object(x.jsx)(j.a,{offset:8,span:8,children:Object(x.jsx)(v.a,{type:"primary",block:!0,onClick:function(){return e=r,t=l,void D.a.auth().signInWithEmailAndPassword(e,t).catch((function(e){Y.a.open({message:"\u767b\u5165\u5931\u6557",description:e.message})}));var e,t},children:"\u767b\u5165"})}),Object(x.jsx)(j.a,{span:8,children:Object(x.jsx)(v.a,{type:"primary",block:!0,onClick:function(){return e=r,t=l,void D.a.auth().createUserWithEmailAndPassword(e,t).then((function(e){Y.a.open({message:"\u8a3b\u518a\u6210\u529f",description:"Automatically sign in."})})).catch((function(e){Y.a.open({message:"\u8a3b\u518a\u5931\u6557",description:e.message})}));var e,t},children:"\u8a3b\u518a"})})]})}):Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)(v.a,{type:"primary",block:!0,onClick:function(){return function(e,t,a){var s=D.a.auth().currentUser;D.a.database().ref("users/".concat(s.uid)).once("value",(function(s){var n=s.val();void 0!==n.tagsStandard&&a(n.tagsStandard),void 0!==n.data&&t(n.data.map((function(e){var t=e;return void 0===t.tags&&(t.tags=[]),t}))),void 0!==n.tags&&e(n.tags)}))}(e.setTags,e.setData,e.setTagsStandard)},children:"\u8f09\u5165\u5b58\u6a94"}),Object(x.jsx)(v.a,{type:"primary",block:!0,onClick:function(){!function(e,t,a){var s=D.a.auth().currentUser;D.a.database().ref("users/".concat(s.uid)).set({tags:e,data:t,tagsStandard:a})}(e.tags,e.data,e.tagsStandard)},style:{marginTop:"8px"},children:"\u5b58\u6a94"}),Object(x.jsx)(v.a,{type:"primary",block:!0,onClick:function(e,t){D.a.auth().signOut()},style:{marginTop:"8px"},children:"\u767b\u51fa"})]})}D.a.apps.length?D.a.app():D.a.initializeApp({apiKey:"AIzaSyAuEKVbi5bNM-V2my8GifCpvYqnEoA5uBI",authDomain:"just-4-fun-e234d.firebaseapp.com",projectId:"just-4-fun-e234d",storageBucket:"just-4-fun-e234d.appspot.com",messagingSenderId:"89823063333",appId:"1:89823063333:web:b0ad61086998c0d66c3ecc",measurementId:"G-GWLHXDENRN"});var T=l.a.Panel,w={"\u5168\u90e8\u4fee\u8ab2":[128,0],"\u672a\u5206\u985e":[0,0],"\u5fc5\u4fee":[45,0],"\u9078\u4fee":[57,0],"\u901a\u8b58":[18,0],"\u6838\u5fc3":[6,0],"\u6838\u5fc3-\u4eba\u6587":[0,1],"\u6838\u5fc3-\u793e\u6703":[0,1],"\u6838\u5fc3-\u81ea\u7136":[0,0],"\u8de8\u9662\u57fa\u672c\u7d20\u990a":[2,0],"\u6821\u57fa\u672c\u7d20\u990a":[6,0],"\u5916\u8a9e":[8,0],"\u9ad4\u80b2":[0,6],"\u8ecd\u8a13":[0,0]};function F(){var e=Object(s.useState)({}),t=Object(i.a)(e,2),a=t[0],n=t[1],c=Object(s.useState)(w),d=Object(i.a)(c,2),u=d[0],b=d[1],h=Object(s.useState)([]),O=Object(i.a)(h,2),g=O[0],f=O[1],p={tags:a,setTags:n,data:g,setData:f,tagsStandard:u,setTagsStandard:b};return Object(x.jsx)("div",{style:{padding:"8px"},children:Object(x.jsxs)(o.a,{gutter:[8,8],children:[Object(x.jsx)(j.a,{xs:{span:24},sm:{span:10},md:{span:8},lg:{span:6},children:Object(x.jsxs)(l.a,{accordion:!0,children:[Object(x.jsx)(T,{header:"\u5e33\u865f",children:Object(x.jsx)(A,Object(r.a)({},p))},0),Object(x.jsx)(T,{header:"\u5c0e\u5165\u6210\u7e3e",children:Object(x.jsx)(y,Object(r.a)({},p))},1),Object(x.jsx)(T,{header:"\u65b0\u589e\u6210\u7e3e",children:Object(x.jsx)(C,Object(r.a)({},p))},2)]})}),Object(x.jsx)(j.a,{xs:{span:24},sm:{span:14},md:{span:16},lg:{span:18},children:Object(x.jsxs)(l.a,{children:[Object(x.jsx)(T,{header:"\u5168\u90e8\u4fee\u8ab2",children:Object(x.jsx)(m,Object(r.a)({tag:"\u5168\u90e8\u4fee\u8ab2",filteredData:g},p))},"\u5168\u90e8\u4fee\u8ab2"),Object(x.jsx)(T,{header:"\u672a\u5206\u985e",children:Object(x.jsx)(m,Object(r.a)({tag:"\u672a\u5206\u985e",filteredData:g.filter((function(e){return 0===e.tags.length}))},p))},"\u672a\u5206\u985e"),Object.keys(a).map((function(e){return Object(x.jsx)(T,{header:e,children:Object(x.jsx)(m,Object(r.a)({tag:e,filteredData:g.filter((function(t){return t.tags.includes(e)}))},p))},e)}))]})})]})})}c.a.render(Object(x.jsx)(F,{}),document.getElementById("root"))}},[[258,1,2]]]);
//# sourceMappingURL=main.c0dae70d.chunk.js.map